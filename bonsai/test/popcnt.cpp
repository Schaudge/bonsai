#include "test/catch.hpp"
#include "popcnt.h"
#include "util.h"
#include <vector>

using namespace emp;
using namespace pop;

TEST_CASE("popcnt") {
    std::vector<uint64_t> vals;
    while(vals.size() < 16) vals.push_back(0);
    vals[15] |= (1 << 16);
    for(auto &el: vals) std::fprintf(stderr, "%zu,", size_t(el));
    std::fprintf(stderr, "\n");
    REQUIRE(vec_popcnt(vals) == 1);
    REQUIRE(bitvec2str(vals) == "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000");
}
